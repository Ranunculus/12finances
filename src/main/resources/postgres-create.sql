-- DROP DATABASE finances;
CREATE DATABASE finances
WITH
OWNER = local
ENCODING = 'UTF8'
LC_COLLATE = 'en_US.UTF-8'
LC_CTYPE = 'en_US.UTF-8'
TABLESPACE = pg_default
CONNECTION LIMIT = -1;

CREATE TABLE CATEGORY (
  ID INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  TRANSACTION_TYPE VARCHAR(256) NOT NULL,
  CATEGORY_NAME VARCHAR(256) NOT NULL,
  CATEGORY_LIMIT DECIMAL
);

CREATE TABLE EXPENSE (
  ID INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  TRANSACTION_TYPE VARCHAR(256),
  AMOUNT DECIMAL(10,2),
  USER_ID INTEGER,
  TRANSACTION_DATE TIMESTAMP,
  CATEGORY_ID INTEGER,
  CONSTRAINT FK_CATEGORY FOREIGN KEY(CATEGORY_ID) REFERENCES CATEGORY(ID)
);

CREATE TABLE INCOME (
  ID INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  TRANSACTION_TYPE VARCHAR(256),
  AMOUNT DECIMAL(10,2),
  USER_ID INTEGER,
  TRANSACTION_DATE TIMESTAMP,
  CATEGORY_ID INTEGER,
  CONSTRAINT FK_CATEGORY FOREIGN KEY(CATEGORY_ID) REFERENCES CATEGORY(ID)
);

CREATE TABLE BUDGET (
  ID INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  BUDGET_TYPE VARCHAR(256),
  AMOUNT DECIMAL(10,2),
  CATEGORY_ID INTEGER,
  CONSTRAINT FK_CATEGORY FOREIGN KEY(CATEGORY_ID) REFERENCES CATEGORY(ID),
  CONSTRAINT BUDGET_NAME UNIQUE (BUDGET_TYPE, CATEGORY_ID)

);